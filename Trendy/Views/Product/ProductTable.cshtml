@model List<Product>
@{
    ViewBag.Title = "ProductTable";

}


<div>
    <form >
        <h3>Search</h3>
        <div class="row">
            
            <div class="col-md-3">
                <div class="form-group">  
                 <input name="Search" id="searchTxt" class="form-control"  placeholder="Search" >
                </div>
            </div>
            <div class="col-md-4">
                <div class="form-group">

                    <div class="row">
                        <div class="col-md-3">
                            <button type="button" id="searchBtn" class="btn aa-browse-btn" >Search</button>
                        </div>
                        <div class="col-md-6">
                            <button type="button" id="newBtn" class="btn aa-browse-btn">New</button>

                        </div>
                    </div>
                </div>
            </div>
        </div>
    </form>

    @*<button type="button" id="searchBtn" class="aa-browse-btn">Search</button>*@
</div>

<br />

<div id="dataContainer" class="table-responsive">
    <table class="table">
        <thead>
            <tr>
                <td>Product Name</td>
                <td>Category</td>
                <td>Price</td>
                <td>Actions</td>
            </tr>
        </thead>
        <tbody>

            @foreach (var product in Model)
            {
                <tr>
                    <td>@product.Name</td>
                    <td>
                        @if (product.Category != null)
                        {
                            <text>@product.Category.Name</text>
                        }
                        else
                        {
                            <text>-</text>
                        }
                    </td>
                    <td>@product.Price</td>
                    <td>
                        <button class="aa-browse-btn btn editProductBtn" data-id="@product.ID">Edit</button>
                        <button class="aa-browse-btn btn deleteProductBtn" data-id="@product.ID">Delete</button>
                    </td>
                </tr>

             }


            
        </tbody>
    </table>
</div>




<script>
      $(document).ready(function () {

        //  $("#tblContainer ").on("click","#searchBtn" ,function () {
          $("#searchBtn" ).on("click",function () {
              

              var searchValue = $('#searchTxt').val();
              console.log(searchValue);
              $.ajax(
                  {
                      type: "Post",
                      url: '@Url.Action("ProductTable")',
                      data: { search: searchValue } ,

                      success: function (result) {
                          $("#tblContainer").html(result);
                          return result;
                      },
                      error: function (result) {
                          console.log(result);
                      }

                  });
          });
          $("#newBtn").on("click", function () {
              
                $.ajax({
                    type: "Get",
                    url: "/Product/Create",
                    success: function (result) {

                        console.log(result);
                        $('#actionContainer').html(result);
                        return result;
                    },
                    error: function (result) {
                        console.log(result);
                    }


                });

          });
          $(".editProductBtn").on("click", function () {
              
              $.ajax({
                 
                  url: "/Product/Edit",
                  data: {
                      ID: $(this).attr("data-id")
                  },
                  success: function (result) {

                      console.log(result);
                      $('#actionContainer').html(result);
                      return result;
                  },
                  error: function (result) {
                      console.log(result);
                  }


              });

          });
          $(".deleteProductBtn").on("click", function () {
              alert("Delete btn clicked");

              var confirmDelete = confirm("Are you sure you want to delete this product?");

              if (confirmDelete) {

                  $.ajax({
                      type: "Post",
                      url: "/Product/Delete",
                      data: {
                          ID: $(this).attr("data-id")
                      },
                      success: function (result) {

                          console.log(result);
                          $('#tblContainer').html(result);
                          return result;
                      },
                      error: function (result) {
                          console.log(result);
                      }


                  });

              }
          });
      });
</script>

