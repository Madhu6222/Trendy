@model List<Product>
@{
    ViewBag.Title = "ProductTable";

}

<h2>ProductTable</h2>

<div>
    <form method="post">
        <input name="Search" id="searchTxt" />
        <button type="button" id="searchBtn">Search</button>
    </form>
    <button type="button" id="newBtn">New</button>
</div>

<div id="dataContainer">
    <table>
        <thead>
            <tr>
                <td>Product Name</td>
                <td>Category</td>
                <td>Price</td>
                <td>Actions</td>
            </tr>
        </thead>
        <tbody>

            @foreach (var product in Model)
            {
                <tr>
                    <td>@product.Name</td>
                    <td> - </td>
                    <td>@product.Price</td>
                    <td>
                        <button class="editProductBtn" data-id="@product.ID">Edit</button>
                        <button class="deleteProductBtn" data-id="@product.ID">Delete</button>
                    </td>
                </tr>

            }
        </tbody>

    </table>
</div>

<div id="actionContainer">

</div>

@*<script>
            $("#searchBtn").on("click", function () {
                var searchValue = $("#searchTxt").val();

                $.ajax({
                    url: '/Product/ProductTable',
                    data: {
                        search: searchValue
                     }
                    })
                        .done(function (response) {
                            alert("SUCCESS");
                            $('#tableContainer').html(response);
                        })
                            .fail(function (XMLHttpRequest, textStatus, errorThrown) {
                                alert('FAIL');
                            });


            });
            $("#newBtn").on("click",function () {

                $.ajax({
                    url: '/Product/Create',

                })
                    .done(function (response) {
                        $('#actionContainer').html(response);
                    })
                    .fail(function (XMLHttpRequest, textStatus, errorThrown) {
                        alert('FAIL');
                    });

            });
    </script>
@section scripts
{}
*@


<script>
      $(document).ready(function () {

        //  $("#tblContainer ").on("click","#searchBtn" ,function () {
          $("#searchBtn" ).on("click",function () {
              alert("search btn clicked");

              var searchValue = $('#searchTxt').val();
              console.log(searchValue);
              $.ajax(
                  {
                      type: "Post",
                      url: '@Url.Action("ProductTable")',
                      data: { search: searchValue } ,

                      success: function (result) {
                          $("#tblContainer").html(result);
                          return result;
                      },
                      error: function (result) {
                          console.log(result);
                      }

                  });
          });
          $("#newBtn").on("click", function () {
              alert("New btn clicked");
                $.ajax({
                    type: "Get",
                    url: "/Product/Create",
                    success: function (result) {

                        console.log(result);
                        $('#actionContainer').html(result);
                        return result;
                    },
                    error: function (result) {
                        console.log(result);
                    }


                });

          });
          $(".editProductBtn").on("click", function () {
              alert("Edit btn clicked");
              $.ajax({
                 
                  url: "/Product/Edit",
                  data: {
                      ID: $(this).attr("data-id")
                  },
                  success: function (result) {

                      console.log(result);
                      $('#actionContainer').html(result);
                      return result;
                  },
                  error: function (result) {
                      console.log(result);
                  }


              });

          });
          $(".deleteProductBtn").on("click", function () {
              alert("Delete btn clicked");

              var confirmDelete = confirm("Are you sure you want to delete this product?");

              if (confirmDelete) {

                  $.ajax({
                      type: "Post",
                      url: "/Product/Delete",
                      data: {
                          ID: $(this).attr("data-id")
                      },
                      success: function (result) {

                          console.log(result);
                          $('#tblContainer').html(result);
                          return result;
                      },
                      error: function (result) {
                          console.log(result);
                      }


                  });

              }
          });
      });
</script>

